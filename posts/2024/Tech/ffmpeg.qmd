---
title: "ffmpeg による音声・動画の変換"
author: "ぷに"
date: 7/18/2024
categories: [Tech]
bibliography: 
    - ../../../assets/mathematics.bib
    - ../../../assets/bib.bib
csl: ../../../assets/apalike.csl
code-fold: false
---

## `ffmpeg` の使い方

```zsh
ffmpeg -i <filename>
```

で情報を表示する．

### 動画を `.gif` に

```zsh
ffmpeg -i <filename> -r 10 -f gif <name>.gif
```

* `-r` はフレームレートを指定する．
* `-f` はフォーマットを指定する．

::: {.callout-important title="注" collapse="true" icon="false"}

```zsh
ffmpeg -i input.mkv -vf "fps=10,scale=320:-1:flags=lanczos" -c:v gif -f gif output.gif
```

* `-vf` はビジュアルフィルタを指定する．
  * `fps=10` はフレームレートを指定する．
  * `scale=320:-1:flags=lanczos` はサイズを指定する．幅を 320 ピクセルとし，高さは自動調節する．
  * `flags=lanczos` は [Lanczos アルゴリズム](https://ja.wikipedia.org/wiki/ランチョス法) を用いて，アンチエイリアスを指定する．
* `-c:v` はビデオコードを指定する．
  * `-c:v gif` は出力のビデオコーデックを GIF にする．
* `-f` はフォーマットを指定する．

codec とは encoder と decoder のかばん語であり，圧縮と復号を司る．

:::

### 動画から音声へ

```zsh
ffmpeg -i <filename> -vn -acodec copy <output filename>
```

* `-vn` は動画でないことを指定 (video not)
* `-acodec copy` は同じストリームを使うことを表す

### 音声を `.mp3` に

```zsh
ffmpeg -i <filename> -acodec libmp3lame <name>.mp3
```

* `-acodec libmp3lame` は音声コードの指定をしている（省略可能）．

### [音声を動画に](https://qiita.com/n-taishi/items/9659dc12c1300c2f00eb)

```zsh
ffmpeg -i <input> -filter_complex "showspectrum" <output>.mp4
```

* `-filter_complex` はフィルタを指定する．
* `showspectrum` は音声の波形を表示する．

::: {.callout-important title="種々の設定" collapse="true" icon="false"}

```zsh
ffmpeg -i multi.wav -filter_complex "showwaves=split_channels=1:mode=line" multi_waves.gif
```

* `showwaves` は音声の波形を表示する．
* `split_channels=1` はチャンネルを 1 つにする．
* `mode=line` は波形の表示方法を直結びにする．

:::